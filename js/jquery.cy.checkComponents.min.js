$.fn.checkComponents=function(options){var settings=$.extend({paramType:"select",data:"1,2,3,4,5,6",inputId1:"input1",inputId2:"param2",readonly:true,formula:"*",digit:2},options);var valuepools,valuein;if(settings.paramType=="select"){if(settings.data==""){var id=$(this).attr("id");document.getElementById(id).options.add(new Option("暂无记录",""))}else{if(settings.data.indexOf("select")>-1){jQuery.ajax({type:"POST",async:false,url:"${rc.contextPath}/search/searchSelectValue.json",data:{data:settings.data,id:subdetailid,},dataType:"json",success:function(data){var selectpool=new Array();for(var i=0;i<data.length;i++){selectpool.push(data[i].t_warehouse_name)}valuepools=data},error:function(){alert("出错啦~！")}});var selectId=document.getElementById($(this).attr("id"));for(var i=0;i<valuepools.length;i++){selectId.options.add(new Option(valuepools[i].name,valuepools[i].name))}}else{var ckoption="";var dataArr=new Array();dataArr=settings.data.split(",");var selectId=document.getElementById($(this).attr("id"));for(i=0;i<dataArr.length;i++){selectId.options.add(new Option(dataArr[i],dataArr[i]))}}}}if(settings.paramType=="string"){var resultinput=document.getElementById($(this).attr("id"));resultinput.readOnly=settings.readonly;document.getElementById(settings.inputId1).addEventListener("blur",function(){var input1data=(document.getElementById(settings.inputId1).value).replace(/,/g,"");var input2data=(document.getElementById(settings.inputId2).value).replace(/,/g,"");var result=input1data+settings.formula+input2data;if(input1data!=""&&input2data!=""){var res=eval(result).toFixed(settings.digit);var a=res.split(".");var r=a[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});resultinput.value=r+"."+a[1]}});document.getElementById(settings.inputId2).addEventListener("blur",function(){var input1data=(document.getElementById(settings.inputId1).value).replace(/,/g,"");var input2data=(document.getElementById(settings.inputId2).value).replace(/,/g,"");var result=input1data+settings.formula+input2data;if(input1data!=""&&input2data!=""){var res=eval(result).toFixed(settings.digit);var a=res.split(".");var r=a[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});resultinput.value=r+"."+a[1]}})}if(settings.paramType=="input"){var num=document.getElementById($(this).attr("id"));if(settings.data.indexOf("select")>-1){jQuery.ajax({type:"POST",async:false,url:"${rc.contextPath}/search/searchSelectValue.json",data:{data:settings.data,id:subdetailid,},dataType:"json",success:function(data){var selectpool=new Array();for(var i=0;i<data.length;i++){selectpool.push(data[i].t_warehouse_name)}var valuepool=data;for(var z in valuepool){valuein=valuepool[z]}},error:function(){alert("出错啦~！")}});num.value=valuein;num.value.replace(/[^\d\.-]/g,"");var digit_thousands=num.value.split(".");var r=digit_thousands[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});if(digit_thousands[1]==undefined){digit_thousands[1]="00"}num.value=r+"."+digit_thousands[1]}else{if(settings.data==""){num.value="0.00"}else{num.value=settings.data;num.value.replace(/[^\d\.-]/g,"");var digit_thousands=num.value.split(".");var r=digit_thousands[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});if(digit_thousands[1]==undefined){digit_thousands[1]="00"}num.value=r+"."+digit_thousands[1]}}}};$.fn.checkNumber=function(options){var settings=$.extend({toplimit:"",lowerlimit:"",defaultvalue:"0",digit:"2"},options);var num=document.getElementById($(this).attr("id"));num.addEventListener("blur",function(){var tplmt=settings.toplimit.toString();var lwlmt=settings.lowerlimit.toString();var rettoplimit;if(tplmt.indexOf("select")>-1){jQuery.ajax({type:"POST",async:false,url:"${rc.contextPath}/search/searchSelectValue.json",data:{data:tplmt,id:subdetailid,},dataType:"json",success:function(data){var selectpool=new Array();for(var i=0;i<data.length;i++){selectpool.push(data[i].t_warehouse_name)}var valuepool=data;for(var z in valuepool){rettoplimit=valuepool[z]}},error:function(){alert("出错啦~！")}})}else{if(tplmt==""){rettoplimit=Infinity}else{rettoplimit=tplmt}}var retlowerlimit;if(lwlmt.indexOf("select")>-1){jQuery.ajax({type:"POST",async:false,url:"${rc.contextPath}/search/searchSelectValue.json",data:{data:lwlmt,id:subdetailid,},dataType:"json",success:function(data){var selectpool=new Array();for(var i=0;i<data.length;i++){selectpool.push(data[i].t_warehouse_name)}var valuepool=data;for(var z in valuepool){retlowerlimit=valuepool[z]}},error:function(){alert("出错啦~！")}})}else{if(lwlmt==""){retlowerlimit=-Infinity}else{retlowerlimit=lwlmt}}num.value.replace(/[^\d\.-]/g,"");var default_digit="0.";var default_digit_p="";for(var i=0;i<settings.digit;i++){default_digit=default_digit+"0";default_digit_p=default_digit_p+"0"}var default_digit_f="."+default_digit_p;var digit_regular=eval("/\\d+\\.\\d{"+settings.digit+"}/");if(num.value.indexOf("--")!=-1){num.value=default_digit}if(num.value.indexOf("..")!=-1){num.value=default_digit}if(num.value.indexOf("-")>0){num.value=default_digit
}if(num.value.indexOf("-")==0){var digit_negative=num.value.replace("-","");digit_negative+="";digit_negative=digit_negative.replace(/[^0-9|\.]/g,"");if(/^0+/.test(digit_negative)){digit_negative=digit_negative.replace(/^0+/,"")}if(!/\./.test(digit_negative)){digit_negative+=default_digit_f}if(/^\./.test(digit_negative)){digit_negative="0"+digit_negative}digit_negative+=default_digit_p;digit_negative=digit_negative.match(digit_regular)[0];num.value="-"+digit_negative}if(num.value.indexOf("-")==-1){num.value+="";num.value=num.value.replace(/[^0-9|\.]/g,"");if(/^0+/){num.value=num.value.replace(/^0+/,"")}if(!/\./.test(num.value)){num.value+=default_digit_f}if(/^\./.test(num.value)){num.value="0"+num.value}num.value+=default_digit_p;num.value=num.value.match(digit_regular)[0]}var digit_thousands=num.value.split(".");var r=digit_thousands[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});num.value=r+"."+digit_thousands[1];var atoplimit=parseFloat(rettoplimit);var alowerlimit=parseFloat(retlowerlimit);var limitnum=(num.value).replace(/,/g,"");if(atoplimit==""&&alowerlimit==""){$(num).parent().parent().find("input[ id="+num.id+"]").trigger("focus");$(num).parent().parent().find("input[ id="+num.id+"]").trigger("blur");return}else{if(atoplimit==null&&alowerlimit==null){$(num).parent().parent().find("input[ id="+num.id+"]").trigger("focus");$(num).parent().parent().find("input[ id="+num.id+"]").trigger("blur");return}else{if(atoplimit==null&&alowerlimit!=null){if(limitnum<alowerlimit){alert("超出范围！");$(num).parent().parent().find("input[ id="+num.id+"]").val(settings.defaultvalue);$(num).parent().parent().find("input[ id="+num.id+"]").trigger("focus");$(num).parent().parent().find("input[ id="+num.id+"]").trigger("blur")}}else{if(atoplimit!=null&&alowerlimit==null){if(limitnum>atoplimit){alert("超出范围！");$(num).parent().parent().find("input[ id="+num.id+"]").val(settings.defaultvalue);$(num).parent().parent().find("input[ id="+num.id+"]").trigger("focus");$(num).parent().parent().find("input[ id="+num.id+"]").trigger("blur")}}else{if(limitnum<alowerlimit||limitnum>atoplimit){alert("超出范围！");$(num).parent().parent().find("input[ id="+num.id+"]").val(settings.defaultvalue);$(num).parent().parent().find("input[ id="+num.id+"]").trigger("focus");$(num).parent().parent().find("input[ id="+num.id+"]").trigger("blur")}}}}}})};$.fn.countNumber=function(options){var settings=$.extend({formulaString:"input1&+&input2",digit:2,readonly:true},options);var resulltinput=$(this).attr("id");document.getElementById(resulltinput).readOnly=settings.readonly;var arr=settings.formulaString.split("&");var inputarr=new Array();for(var i in arr){if(arr[i].indexOf("input")==0){inputarr.push(arr[i])}}var p=/[a-z]/i;for(var i in inputarr){if($("#"+inputarr[i]).length>0){document.getElementById(inputarr[i]).addEventListener("blur",function(){var agetform=settings.formulaString.replace(/&/g,"");for(var i in inputarr){if($("#"+inputarr[i]).length>0){agetform=agetform.replace(inputarr[i],document.getElementById(inputarr[i]).value);if(document.getElementById(inputarr[i]).value!=""&&p.test(agetform)==false){try{var res=eval(agetform.replace(/,/g,"")).toFixed(settings.digit);var a=res.split(".");var r=a[0].replace(/\d+?(?=(?:\d{3})+$)/g,function(s){return s+","});res=r+"."+a[1]}catch(err){}if(res=="Infinity.undefined"||res=="NaN.undefined"){res="分母不能为0"}if(res==undefined){res=""}document.getElementById(resulltinput).value=res}}else{alert("不存在控件！")}}})}else{alert("不存在控件！")}}};